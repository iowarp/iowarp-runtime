#!/usr/bin/make -f

# Debian rules file for chimaera-runtime
# Uses CMake build system

export DH_VERBOSE = 1
export DEB_BUILD_MAINT_OPTIONS = hardening=+all

# Number of parallel build jobs
NUMJOBS = $(shell nproc)

%:
	dh $@ --buildsystem=cmake --parallel

override_dh_auto_configure:
	dh_auto_configure -- \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DBUILD_TESTING=OFF \
		-DBUILD_SHARED_LIBS=ON

override_dh_auto_build:
	dh_auto_build -- -j$(NUMJOBS)

override_dh_auto_install:
	dh_auto_install --destdir=debian/chimaera-runtime

override_dh_auto_test:
	# Skip tests during package build (they require runtime environment)
	@echo "Skipping tests during package build"

override_dh_shlibdeps:
	dh_shlibdeps --dpkg-shlibdeps-params=--ignore-missing-info
